---
main_topsize: 0.15 #percent coverage of the poster
main_bottomsize: 0.05
title: '**Spatial Point Processes with INLA: are finer covariate resolutions always better?**'
author:
  - name: Sara Martino
    affil: 1
    main: true
    email: 'sara.martino@ntnu.no'
  - name: Jafet Belmont
    affil: 2
    main: true
    email: 'Jafet.BelmontOsuna@glasgow.ac.uk'
  - name: Erin Bryce
    affil: 2
    main: true
    email: 'Erin.Bryce@glasgow.ac.uk'
  - name: Leonardo Capitani 
    affil: 3
    main: true
    email: 'leocapi07@gmail.com'
  - name: Virginia Morera-Pujol
    affil: 4
    main: true
    email: 'morera.virginia@gmail.com'
  - name: Megan Morton
    affil: 2
    main: true
    email: 'Megan.Laxton@glasgow.ac.uk'
  - name: Janine Illian 
    affil: 2
    main: true
    email: 'Janine.Illian@glasgow.ac.uk'
    
affiliation:
  - num: 1
    address: Department of Mathematical Sciences, Norwegian University of Science and Technology
  - num: 2
    address: School of Mathematics and Statistics, University of Glasgow
  - num: 3
    address: Swiss Federal Institute for Forest, Snow and Landscape Research WSL, Birmensdorf, Switzerland
  - num: 4
    address: Laboratory of Wildlife Ecology and Behaviour, School of Biology and Environmental Science, Univ. College Dublin, Dublin, Ireland

main_findings:
  - "The model only *sees* the covariate values at the integration points. Therefore, **the integration scheme and the covariates need to have similar resolution**"
  
logoleft_name: https&#58;//raw.githubusercontent.com/jhollway/iheiddown/main/man/figures/iheiddown.png
logoright_name: https&#58;//raw.githubusercontent.com/jhollway/iheiddown/main/man/figures/iheiddown.png
logocenter_name: https&#58;//raw.githubusercontent.com/jhollway/iheiddown/main/man/figures/iheiddown.png
output: 
  iheiddown::iheiddown_betterport:
    self_contained: false
    pandoc_args: --mathjax
    number_sections: false
bibliography: packages.bib
link-citations: true
editor_options: 
  markdown: 
    wrap: 72
  chunk_output_type: console
---

```{r, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      warning = FALSE,
                      tidy = FALSE,
                      message = FALSE,
                      fig.align = 'center',
                      out.width = "100%")
options(knitr.table.format = "html") 
```

<!--# Author's order: I think we agreed Sara first and then alphabetical order and that's how's in the abstract so leaving it like that! -->

# Rationale

In ecology, spatial point processes (SPP) have become a popular
statistical tool, and INLA/SPDE an efficient method to implement 
them and make efficient inference. Central to this approach is the
representation of a spatially continuous Gaussian random field as the
solution of a stochastic partial differential equation (SPDE) defined
over a triangular mesh spanning the spatial domain. Although the mesh definition
is an important part of the model implementation. Equally crucial, yet
often overlooked, is the role of integration points employed in
numerically solving the stochastic integral inherent in the LGCP
likelihood.

<!-- Intro: I would love this to be a bit shorter and maybe a bit less technical, worth giving it some thought. Also need to make sure we convey the message that this is not SPDE/INLA's fault, and this intro is very inla/SPDE centric which I'm not sure conveys that. The word covariate is not even mentioned! The main message is that we need to chose covariates that act at a scale appropirate for the mesh/ipoints, not that the mesh and the ipoints can be thought of separately -->

# Main problem

When  using the INLA/SPDE implementation, the model only _sees_ the covariates at the integration points. Therefore, a covariate with a range much shorter than the distance between integration points will cause the model to provide unreliable inference. 

```{r, cropsfigure, fig.cap='In environmental variables with very short range like the one pictured below, the values change from 100 to 0 in very short distances. If the resolution of the integration points is not small enough to capture this short range, the model will struggle to infer the effect of the covariate, and the coefficients produced will be unreliable', out.width="90%"}

library(tidyterra)
library(ggplot2)
library(terra)

crops <- rast("ISEC_poster/crops.grd")
crops <- trim(crops)

ggplot() +
  geom_spatraster(data = crops) +
  scale_fill_whitebox_c(
    palette = "muted",
    labels = scales::label_number(suffix = "%"),
    n.breaks = 12,
    guide = guide_legend(reverse = TRUE)
  ) +
  
  labs(
    fill = "",
    title = "Planted vegetation and crops",
    subtitle = "Based on the CORINE 2016 data"
  ) + 
  theme_bw()
```

<!-- Main problem: I'd love to make this figure a bit bigger, like have the plot as wide as the column of text. Do you know how to do that?  -->
# Methods

I will show here how to include poster elements that may be useful, such
as an equation using mathjax:

$$
E = mc^2
$$

To reference a citation you can add your `.bib` file to the working
directory and name it in the YAML metadata or generate an automated one
as done here, then you only need to reference the label value in the
`.bib` file [@dambly2023]. For example this package is built on top of
the wonderful {pagedown} package and I will cite it at the end of this
sentence using this in the rmd [@pagedown].

To get a better understanding of how to include features like these
please refer to the {iheiddown}
[wiki](https://github.com/iheiddown/wiki).

***Now on to the results!***

# Results

Here you may have some figures to show off, bellow I have made a
scatterplot with the infamous Iris dataset and I can even reference to
the figure automatically like this, `Figure \@ref(fig:irisfigure)`,
Figure \@ref(fig:irisfigure).


Maybe you want to show off some of that fancy code you spent so much
time on to make that figure, well you can do that too! Just use the
`echo=TRUE` option in the r code chunk options, Figure
\@ref(fig:myprettycode)!

```{r myprettycode, echo=TRUE, fig.cap='Boxplots, so hot right now!', fig.height=6, out.width="80%"}
#trim whitespace
par(mar=c(2,2,0,0))
#plot boxplots
boxplot(iris$Sepal.Width~iris$Species,
        col = "#ed2215", 
        border = "#800000",
        ylab = "Sepal Width (cm)",
        xlab = "Species")
```

How about a neat table of data? See, Table \@ref(tab:iristable):

```{r, iristable}
knitr::kable(
  iris[1:15,1:5], format = "html",
  caption = "A table made with the **knitr::kable** function.",
  align = "c", col.names = c("Sepal <br> Length",
                             "Sepal <br> Width",
                             "Petal <br> Length",
                             "Petal <br> Width",
                             "Species"),
  escape = FALSE)
```

# Conclusions

Using both simulations and real-world ecological data, we illustrate
these challenges and offer guidelines to empower users in navigating
these complexities and mitigating potential pitfalls when using these
methods in ecological applications such as species distribution models
based on presence-only data.

# References
